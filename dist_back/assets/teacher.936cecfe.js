import{d as U,s as oe,v as o,S as q,K as re,x as se,E as pe,T as ie,o as r,a as $,y as s,e as ne,j as p,w as l,f as j,I as i,l as _,F as ce,z as de}from"./index.12244a07.js";import{T as V,E as me,_ as Ee,a as Fe}from"./table-search.9a52be5d.js";import"./el-tag.9c674d0f.js";import"./el-select.ff2d79de.js";import{b as R,d as P,g as be,u as fe,c as ye}from"./index.e2c71170.js";import{T as Be,E as ge}from"./table-custom.f6f335e2.js";import{E as ve,a as De,b as Ce}from"./index.01a27f37.js";import{E as d}from"./index.85100a56.js";import"./event.1aa8b38f.js";import"./index.4d06eba3.js";import"./scroll.4bdf40b7.js";import"./el-form-item.ce222cb9.js";import"./_baseClone.ce459c13.js";import"./_Uint8Array.869745a5.js";import"./_initCloneObject.d1045298.js";import"./el-col.9d5e7896.js";import"./el-progress.d9524178.js";import"./cloneDeep.249e6c55.js";import"./isEqual.3cc19f5b.js";import"./el-date-picker.da63982f.js";/* empty css                 */import"./el-input-number.6962d3b9.js";import"./index.318875f8.js";import"./index.bccee1bd.js";import"./index.e921f451.js";import"./el-table-column.53d704a2.js";import"./isPlainObject.e6d32bd1.js";import"./_baseIteratee.ef24a81b.js";import"./debounce.b932a66e.js";import"./el-checkbox.4a8a00ed.js";import"./raf.294279dc.js";import"./index.07ec0462.js";import"./date.8d8ac76d.js";import"./axios.bf444489.js";import"./el-divider.e8ffbcc2.js";import"./strings.c7fbc6d7.js";const Ae={class:"container"},he=U({name:"system-user"}),iu=U({...he,setup(we){const L=oe(),M=()=>{L.push("/login"),d.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25")};console.log(V.props,"search"),o(""),o("");const I=q({}),O=o([{type:"input",label:"\u9898\u76EE\u67E5\u8BE2\uFF1A",prop:"TitleName"},{type:"input",label:"\u540D\u79F0\u67E5\u8BE2",prop:"projectpracticeName"},{type:"input",label:"\u5DE5\u53F7/\u59D3\u540D\uFF1A",prop:"teacherName"}]);let H=o([{type:"selection",width:55,align:"center"},{prop:"ad",label:"\u5E8F\u53F7",width:55,align:"center"},{prop:"projectpracticeCode",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u7F16\u53F7",width:200},{prop:"title",label:"\u9898\u76EE",width:250},{prop:"teacherName",label:"\u6307\u5BFC\u8001\u5E08",width:150},{prop:"teacherSno",label:"\u5DE5\u53F7",width:150},{prop:"guidanceTime",label:"\u6307\u5BFC\u65F6\u95F4",width:150},{prop:"guidancePlace",label:"\u6307\u5BFC\u5730\u70B9",width:150},{prop:"studentRequirements",label:"\u6700\u5927\u53EF\u9009\u4EBA\u6570",width:150},{prop:"studentHave",label:"\u5DF2\u9009\u4EBA\u6570",width:100},{prop:"studentNeed",label:"\u5269\u4F59\u4EBA\u6570",width:100},{prop:"budget",label:"\u7ECF\u8D39",width:100},{prop:"releaseStatus",label:"\u662F\u5426\u53D1\u5E03",width:100},{prop:"reimburse",label:"\u662F\u5426\u5DF2\u62A5\u9500",width:100},{prop:"operator",label:"\u64CD\u4F5C",width:250,fixed:"right"}]);const n=q({index:1,size:10,total:0}),v=o([]),m=o("");re(m,(u,e)=>{console.log(`\u9009\u4E2D\u7684\u503C\u4ECE ${e} \u53D8\u4E3A ${u}`),c(1,0)});const S=o(0),D=o([]);let b=localStorage.getItem("v_codes");b=JSON.parse(b),console.log(b,"esp"),Array.isArray(b)&&b.forEach(u=>{v.value.push({value:u.projectPracticeCode,label:u.projectPracticeName})}),v.value.length>0&&(m.value=v.value[0].value);const c=async(u,e)=>{const t=await R(u,e,m.value,"","","");t=="Request failed with status code 403"&&M(),D.value=t.SetTopicInfoList,n.total=t.total,S.value++,console.log(t,D.value,"tableData")};c(1,0);const z=async u=>{if(!u.TitleName&&!u.projectpracticeName&&!u.teacherName)c(1,0);else{const e=await R(1,0,m.value,u.TitleName,u.projectpracticeName,u.teacherName);e==null?d.error("\u67E5\u8BE2\u5931\u8D25"):(D.value=e.SetTopicInfoList,n.total=e.total,S.value++)}};async function K(){ge.confirm("\u786E\u5B9A\u8981\u5BFC\u51FA\u8868\u683C\u5417\uFF1F","\u63D0\u793A",{type:"info"}).then(async()=>{const u=await be(m.value);if(u.code==50)d({type:"warning",message:"\u5BFC\u51FA\u5931\u8D25"});else{const e=window.URL.createObjectURL(new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");t.href=e,t.setAttribute("download","data.xlsx"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e),d({type:"success",message:"\u5BFC\u51FA\u6210\u529F"})}}).catch(()=>{})}const W=(u,e,t)=>{n.index=u,c(n.index,t)};function C(u){const e=new Date(u),t=e.getFullYear(),f=e.getMonth()+1,F=e.getDate(),y=e.getHours(),B=e.getMinutes(),g=e.getSeconds(),T=f<10?`0${f}`:f,w=F<10?`0${F}`:F,a=y<10?`0${y}`:y,ae=B<10?`0${B}`:B,le=g<10?`0${g}`:g;return`${t}-${T}-${w} ${a}:${ae}:${le}`}let J=o({labelWidth:"120px",span:22,list:[{type:"input",label:"\u9898\u76EE\u7F16\u53F7",prop:"projectpracticeCode",required:!0},{type:"sss",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u7F16\u53F7",prop:"projectpracticeCode",required:!0},{type:"input",label:"\u9898\u76EE",prop:"title",required:!0},{type:"input",label:"\u6307\u5BFC\u8001\u5E08",prop:"teacherName",required:!0},{type:"input",label:"\u6700\u5927\u53EF\u9009\u4EBA\u6570",prop:"studentRequirements",required:!0},{type:"input",label:"\u6307\u5BFC\u5730\u70B9",prop:"guidancePlace",required:!0},{type:"input",label:"\u6307\u5BFC\u65F6\u95F4",prop:"guidanceTime",required:!0},{type:"input",label:"\u7ECF\u8D39",prop:"budget",required:!0},{type:"select",label:"\u662F\u5426\u5DF2\u62A5\u9500",prop:"reimburse",required:!0,options:[{label:"\u5DF2\u62A5\u9500",value:1},{label:"\u672A\u62A5\u9500",value:0}]}]}),Y=o({labelWidth:"120px",span:22,list:[{type:"input",label:"\u9898\u76EE",prop:"projectpracticeName",required:!0},{type:"sss",label:"\u5DF2\u9009\u8BFE\u5B66\u751F",prop:""},{type:"input",label:"\u6307\u5BFC\u8001\u5E08",prop:"teacher_name",required:!0},{type:"input",label:"\u6700\u5927\u53EF\u9009\u4EBA\u6570",prop:"studentRequirements",required:!0},{type:"input",label:"\u6307\u5BFC\u5730\u70B9",prop:"guidance_place",required:!0},{type:"date",label:"\u6307\u5BFC\u65F6\u95F4",prop:"guidance_time",required:!0},{type:"input",label:"\u7ECF\u8D39",prop:"budget",required:!0},{type:"select",label:"\u662F\u5426\u5DF2\u62A5\u9500",prop:"reimburse",required:!0}]});const A=o(!1),G=o(!1),E=o(!1);o(!1);const h=o({}),Q=u=>{h.value={...u},E.value=!0,A.value=!0,c(1,0)},X={\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316:"0101",\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F:"0102",\u673A\u5668\u4EBA\u5DE5\u7A0B:"0104",\u81EA\u52A8\u5316:"0103"},Z=async u=>{if(u.selectEtime=C(u.selectEtime),u.selectStime=C(u.selectStime),u.titleEtime=C(u.titleEtime),u.titleStime=C(u.titleStime),u.majorCode=X[u.majorName],E.value)if(console.log(u,"\u7F16\u8F91\u6570\u636E"),"projectpracticeCode"in h.value){u.projectpracticeCode=h.value.projectpracticeCode;const e=await fe(u);console.log(e,"\u66F4\u65B0\u6570\u636E")}else console.log("\u65E0\u6570\u636E");else{const e=await ye(u);console.log(e,"\u65B0\u5EFA\u6570\u636E")}k(),setTimeout(()=>{c(1,0)},500)},k=()=>{A.value=!1,G.value=!1,E.value=!1},x=o(!1),N=o({row:{},list:[]}),ee=u=>{N.value.row={...u},N.value.list=[{prop:"projectpracticeCode",label:"\u9898\u76EE\u7F16\u53F7"},{prop:"title",label:"\u9898\u76EE"},{prop:"projectpracticeName",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u540D\u79F0"},{prop:"teacherName",label:"\u6307\u5BFC\u8001\u5E08"},{prop:"teacherSno",label:"\u5DE5\u53F7"},{prop:"studentRequirements",label:"\u6700\u5927\u53EF\u9009\u4EBA\u6570"},{prop:"content",label:"\u9898\u76EE\u8BE6\u60C5"},{prop:"resultDisplay",label:"\u9898\u76EE\u4EA4\u4ED8\u8981\u6C42"},{prop:"studentNeed",label:"\u5269\u4F59\u4EBA\u6570"},{prop:"guidancePlace",label:"\u5730\u70B9"},{prop:"guidanceTime",label:"\u65F6\u95F4"},{prop:"budget",label:"\u7ECF\u8D39"},{prop:"status",label:"\u662F\u5426\u62A5\u9500"},{prop:"fabu",label:"\u53D1\u5E03\u72B6\u6001"}],x.value=!0},ue=u=>{let e=[];u.length>0&&u.forEach(t=>{e.push(t.code)}),P(e).then(t=>{d.success("\u5220\u9664\u6210\u529F"),c(1,0),n.index=1}).catch(t=>{d.error("\u5220\u9664\u5931\u8D25")})},te=async u=>{(await P(u.code)).data.message=="success"?d.success("\u5220\u9664\u6210\u529F"):d.error("\u5220\u9664\u5931\u8D25"),c(1,0),n.index=1};return(u,e)=>{const t=ve,f=se("UploadFilled"),F=pe,y=ie,B=De,g=Ce,T=Fe,w=me;return r(),$("div",null,[s(V,{query:I,options:O.value,search:z},null,8,["query","options"]),ne("div",Ae,[(r(),p(Be,{key:S.value,columns:j(H),tableData:D.value,total:n.total,currentPage:n.index,viewFunc:ee,delFunc:te,changePage:W,editFunc:Q,delSelection:ue},{reimburse:l(({rows:a})=>[a.reimburse==0?(r(),p(t,{key:0,type:"warning"},{default:l(()=>e[4]||(e[4]=[i("\u672A\u62A5\u9500")])),_:1})):a.reimburse==1?(r(),p(t,{key:1,type:"success"},{default:l(()=>e[5]||(e[5]=[i("\u5DF2\u62A5\u9500")])),_:1})):_("",!0)]),releaseStatus:l(({rows:a})=>[a.releaseStatus==0?(r(),p(t,{key:0,type:"warning"},{default:l(()=>e[6]||(e[6]=[i("\u672A\u53D1\u5E03")])),_:1})):a.releaseStatus==1?(r(),p(t,{key:1,type:"success"},{default:l(()=>e[7]||(e[7]=[i("\u5DF2\u53D1\u5E03")])),_:1})):_("",!0)]),toolbarBtn:l(()=>[s(y,{type:"success",onClick:e[0]||(e[0]=a=>K())},{default:l(()=>[s(F,{style:{"margin-right":"5px"}},{default:l(()=>[s(F,null,{default:l(()=>[s(f)]),_:1})]),_:1}),e[8]||(e[8]=i(" \u5BFC\u51FA "))]),_:1}),s(g,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=a=>m.value=a),placeholder:"Select",style:{width:"240px","margin-left":"10px"}},{default:l(()=>[(r(!0),$(ce,null,de(v.value,a=>(r(),p(B,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["columns","tableData","total","currentPage"]))]),s(w,{title:E.value?"\u7F16\u8F91":"\u65B0\u589E\u6570\u636E",modelValue:A.value,"onUpdate:modelValue":e[2]||(e[2]=a=>A.value=a),width:"700px","destroy-on-close":"","close-on-click-modal":!1,onClose:k,bu:""},{default:l(()=>[s(T,{"form-data":h.value,options:E.value?j(J):j(Y),edit:E.value,update:Z},null,8,["form-data","options","edit"])]),_:1},8,["title","modelValue"]),s(w,{title:"\u67E5\u770B\u8BE6\u60C5",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=a=>x.value=a),width:"700px","destroy-on-close":""},{default:l(()=>[s(Ee,{data:N.value},{status:l(({rows:a})=>[a.reimburse==0?(r(),p(t,{key:0,type:"warning"},{default:l(()=>e[9]||(e[9]=[i("\u672A\u62A5\u9500")])),_:1})):a.reimburse==1?(r(),p(t,{key:1,type:"success"},{default:l(()=>e[10]||(e[10]=[i("\u5DF2\u62A5\u9500")])),_:1})):_("",!0)]),fabu:l(({rows:a})=>[a.releaseStatus==0?(r(),p(t,{key:0,type:"warning"},{default:l(()=>e[11]||(e[11]=[i("\u672A\u53D1\u5E03")])),_:1})):a.releaseStatus==1?(r(),p(t,{key:1,type:"success"},{default:l(()=>e[12]||(e[12]=[i("\u5DF2\u53D1\u5E03")])),_:1})):_("",!0)]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}});export{iu as default};
