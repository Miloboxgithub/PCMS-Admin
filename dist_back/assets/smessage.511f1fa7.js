import{d as L,s as oe,v as n,S as x,T as le,x as k,E as ae,o as E,a as ne,y as l,e as se,j as A,w as o,f as b,I as d,l as T,U as re}from"./index.12244a07.js";import{T as q,E as ie,_ as pe,a as ce}from"./table-search.9a52be5d.js";import"./el-tag.9c674d0f.js";import{r as S,s as U,t as de,o as me,v as Ee,w as fe}from"./index.e2c71170.js";import{T as Ae,E as j}from"./table-custom.f6f335e2.js";import{a as Be}from"./axios.bf444489.js";import{E as Fe}from"./index.01a27f37.js";import{E as a}from"./index.85100a56.js";import"./event.1aa8b38f.js";import"./index.4d06eba3.js";import"./scroll.4bdf40b7.js";import"./el-form-item.ce222cb9.js";import"./_baseClone.ce459c13.js";import"./_Uint8Array.869745a5.js";import"./_initCloneObject.d1045298.js";import"./el-col.9d5e7896.js";import"./el-progress.d9524178.js";import"./cloneDeep.249e6c55.js";import"./isEqual.3cc19f5b.js";import"./el-date-picker.da63982f.js";import"./el-select.ff2d79de.js";/* empty css                 */import"./el-input-number.6962d3b9.js";import"./index.318875f8.js";import"./index.bccee1bd.js";import"./index.e921f451.js";import"./el-table-column.53d704a2.js";import"./isPlainObject.e6d32bd1.js";import"./_baseIteratee.ef24a81b.js";import"./debounce.b932a66e.js";import"./el-checkbox.4a8a00ed.js";import"./raf.294279dc.js";import"./index.07ec0462.js";import"./date.8d8ac76d.js";import"./el-divider.e8ffbcc2.js";import"./strings.c7fbc6d7.js";const be={class:"container"},ye=L({name:"system-user"}),lu=L({...ye,setup(ve){const R=oe(),V=()=>{R.push("/login"),a.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25")};console.log(q.props,"search"),n(""),n("");const $=x({}),I=n([{type:"input",label:"\u67E5\u8BE2\uFF1A",prop:"sno"}]);let O=n([{type:"selection",width:55,align:"center"},{prop:"ad",label:"\u5E8F\u53F7",width:55,align:"center"},{prop:"name",label:"\u59D3\u540D"},{prop:"sno",label:"\u5B66\u53F7"},{prop:"phone",label:"\u7535\u8BDD"},{prop:"class",label:"\u73ED\u7EA7"},{prop:"major_name",label:"\u4E13\u4E1A"},{prop:"operator",label:"\u64CD\u4F5C",width:250}]);const p=x({index:1,size:10,total:0}),y=n(0),B=n([]),c=async(u,e)=>{const t=await S(u,e,"");t=="Request failed with status code 403"&&V(),B.value=t.StudentInfoList,p.total=t.total,y.value++,console.log(t,B.value,"tableData")};c(1,0);const N=async u=>{if(console.log(u.sno,"queryData"),!u.sno)c(1,0);else{const e=await S(1,0,u.sno);e==null?a.error("\u67E5\u8BE2\u5931\u8D25"):(B.value=e.StudentInfoList,p.total=e.total,y.value++)}};async function Y(){j.confirm("\u786E\u5B9A\u8981\u5BFC\u51FA\u8868\u683C\u5417\uFF1F","\u63D0\u793A",{type:"info"}).then(async()=>{const u=await de();if(u.code==50)a({type:"warning",message:"\u5BFC\u51FA\u5931\u8D25"});else{const e=window.URL.createObjectURL(new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");t.href=e,t.setAttribute("download","data.xlsx"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e),a({type:"success",message:"\u5BFC\u51FA\u6210\u529F"})}}).catch(()=>{})}const P=async()=>{const u=document.createElement("input");u.type="file",u.accept=".xlsx, .xls",u.addEventListener("change",e=>{const r=e.target.files;if(r.length===0){a.error("\u8BF7\u9009\u62E9\u6587\u4EF6");return}const g=r[0];try{const i=new FormData;i.append("teacherfile",g);const F=Be.post("/api/superadmin/createbatchstudent",i,{headers:{"Content-Type":"multipart/form-data",Authorization:localStorage.getItem("vuems_token")}});console.log("File uploaded successfully:",F),a.success("\u6587\u4EF6\u5BFC\u5165\u6210\u529F"),setTimeout(()=>{c(1,0)},500)}catch(i){console.error("Error uploading file:",i),a.error("\u6587\u4EF6\u5BFC\u5165\u5931\u8D25")}}),u.click()};async function z(){j.confirm("\u786E\u5B9A\u8981\u4E0B\u8F7D\u6A21\u677F\u5417\uFF1F","\u63D0\u793A",{type:"info"}).then(async()=>{const u=await me("student");if(u.code==50)a({type:"warning",message:"\u4E0B\u8F7D\u5931\u8D25"});else{const e=window.URL.createObjectURL(new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");t.href=e,t.setAttribute("download","template.xlsx"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e),a({type:"success",message:"\u4E0B\u8F7D\u6210\u529F"})}}).catch(()=>{})}const M=(u,e,t)=>{p.index=u,c(p.index,t)};function W(u){const e=new Date().getFullYear(),t=[];for(let r=0;r<u;r++)t.push({label:e-r,value:e-r});return t}const w=W(4);let K=n({labelWidth:"140px",span:12,list:[{type:"input",label:"\u59D3\u540D",prop:"name",required:!0},{type:"input",label:"\u5B66\u53F7",prop:"sno",required:!0},{type:"input",label:"\u624B\u673A\u53F7",prop:"phone",required:!0},{type:"input",label:"\u73ED\u7EA7",prop:"class",required:!0},{type:"select",label:"\u5E74\u7EA7",prop:"grade",required:!0,options:w},{type:"select",label:"\u4E13\u4E1A",prop:"major_name",required:!0,options:[{label:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316",value:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316"},{label:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F",value:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F"},{label:"\u81EA\u52A8\u5316",value:"\u81EA\u52A8\u5316"},{label:"\u673A\u5668\u4EBA\u5DE5\u7A0B",value:"\u673A\u5668\u4EBA\u5DE5\u7A0B"}]}]}),G=n({labelWidth:"140px",span:12,list:[{type:"input",label:"\u59D3\u540D",prop:"name",required:!0},{type:"input",label:"\u5B66\u53F7",prop:"sno",required:!0},{type:"input",label:"\u624B\u673A\u53F7",prop:"phone",required:!0},{type:"input",label:"\u73ED\u7EA7",prop:"class",required:!0},{type:"select",label:"\u5E74\u7EA7",prop:"grade",required:!0,options:w},{type:"select",label:"\u4E13\u4E1A",prop:"major_name",required:!0,options:[{label:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316",value:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316"},{label:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F",value:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F"},{label:"\u81EA\u52A8\u5316",value:"\u81EA\u52A8\u5316"},{label:"\u673A\u5668\u4EBA\u5DE5\u7A0B",value:"\u673A\u5668\u4EBA\u5DE5\u7A0B"}]}]});const f=n(!1),H=n(!1),m=n(!1);n(!1);const C=n({}),J=u=>{C.value={...u},m.value=!0,f.value=!0,c(1,0)},Q={\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316:"0101",\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F:"0102",\u673A\u5668\u4EBA\u5DE5\u7A0B:"0104",\u81EA\u52A8\u5316:"0103"},X=async u=>{if(u.major_code=Q[u.major_name],m.value){const e=await Ee(u);console.log(e,"\u66F4\u65B0\u6570\u636E"),e.code!=50?a.success("\u7F16\u8F91\u6210\u529F"):a.error("\u7F16\u8F91\u5931\u8D25")}else{const e=await fe(u);console.log(e,"\u65B0\u5EFA\u6570\u636E"),e.code!=50?a.success("\u65B0\u5EFA\u6210\u529F"):a.error("\u65B0\u5EFA\u5931\u8D25")}_(),setTimeout(()=>{c(1,0)},500)},_=()=>{f.value=!1,H.value=!1,m.value=!1},v=n(!1),D=n({row:{},list:[]}),Z=u=>{D.value.row={...u},D.value.list=[{prop:"name",label:"\u59D3\u540D"},{prop:"sno",label:"\u5B66\u53F7"},{prop:"phone",label:"\u7535\u8BDD"},{prop:"class",label:"\u73ED\u7EA7"},{prop:"major_name",label:"\u4E13\u4E1A"}],v.value=!0},ee=u=>{let e=[];u.length>0&&u.forEach(t=>{e.push(t.sno)}),U(e).then(t=>{a.success("\u5220\u9664\u6210\u529F"),c(1,0),p.index=1}).catch(t=>{a.error("\u5220\u9664\u5931\u8D25")})},ue=async u=>{let e=[u.sno];(await U(e)).code!=50?a.success("\u5220\u9664\u6210\u529F"):a.error("\u5220\u9664\u5931\u8D25"),c(1,0),p.index=1};return(u,e)=>{const t=Fe,r=le,g=k("Bottom"),i=ae,F=k("UploadFilled"),te=ce,h=ie;return E(),ne("div",null,[l(q,{query:$,options:I.value,search:N},null,8,["query","options"]),se("div",be,[(E(),A(Ae,{key:y.value,columns:b(O),tableData:B.value,total:p.total,currentPage:p.index,viewFunc:Z,delFunc:ue,changePage:M,editFunc:J,delSelection:ee},{reimburse:o(({rows:s})=>[s.reimburse==0?(E(),A(t,{key:0,type:"warning"},{default:o(()=>e[6]||(e[6]=[d("\u672A\u62A5\u9500")])),_:1})):s.reimburse==1?(E(),A(t,{key:1,type:"success"},{default:o(()=>e[7]||(e[7]=[d("\u5DF2\u62A5\u9500")])),_:1})):T("",!0)]),toolbarBtn:o(()=>[l(r,{type:"warning",icon:b(re),onClick:e[0]||(e[0]=s=>{f.value=!0,m.value=!1})},{default:o(()=>e[8]||(e[8]=[d("\u65B0\u589E\u6570\u636E")])),_:1},8,["icon"]),l(r,{type:"danger",onClick:e[1]||(e[1]=s=>z())},{default:o(()=>[l(i,{style:{"margin-right":"5px"}},{default:o(()=>[l(i,null,{default:o(()=>[l(g)]),_:1})]),_:1}),e[9]||(e[9]=d(" \u4E0B\u8F7D\u6A21\u677F "))]),_:1}),l(r,{type:"primary",onClick:e[2]||(e[2]=s=>P())},{default:o(()=>[l(i,{style:{"margin-right":"5px"}},{default:o(()=>[l(i,null,{default:o(()=>[l(F)]),_:1})]),_:1}),e[10]||(e[10]=d(" \u6279\u91CF\u5BFC\u5165 "))]),_:1}),l(r,{type:"success",onClick:e[3]||(e[3]=s=>Y())},{default:o(()=>[l(i,{style:{"margin-right":"5px"}},{default:o(()=>[l(i,null,{default:o(()=>[l(F)]),_:1})]),_:1}),e[11]||(e[11]=d(" \u5BFC\u51FA "))]),_:1})]),_:1},8,["columns","tableData","total","currentPage"]))]),l(h,{title:m.value?"\u7F16\u8F91":"\u65B0\u589E\u6570\u636E",modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),width:"700px","destroy-on-close":"","close-on-click-modal":!1,onClose:_,bu:""},{default:o(()=>[l(te,{"form-data":C.value,options:m.value?b(K):b(G),edit:m.value,update:X},null,8,["form-data","options","edit"])]),_:1},8,["title","modelValue"]),l(h,{title:"\u67E5\u770B\u8BE6\u60C5",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=s=>v.value=s),width:"700px","destroy-on-close":""},{default:o(()=>[l(pe,{data:D.value},{status:o(({rows:s})=>[s.reimburse==0?(E(),A(t,{key:0,type:"warning"},{default:o(()=>e[12]||(e[12]=[d("\u672A\u62A5\u9500")])),_:1})):s.reimburse==1?(E(),A(t,{key:1,type:"success"},{default:o(()=>e[13]||(e[13]=[d("\u5DF2\u62A5\u9500")])),_:1})):T("",!0)]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}});export{lu as default};
