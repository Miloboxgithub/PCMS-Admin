import{d as I,v as E,s as x,S as A,d3 as U,d4 as N,x as g,o as T,a as $,e as m,d5 as q,y as u,w as t,aB as L,I as C,E as M,T as P,A as z}from"./index.12244a07.js";import{E as J,a as K}from"./el-form-item.ce222cb9.js";import{E as O}from"./el-link.76fb923c.js";import{E as j}from"./el-checkbox.4a8a00ed.js";/* empty css                 */import{a as R}from"./axios.bf444489.js";import{E as r}from"./index.85100a56.js";import{E as h}from"./index.318875f8.js";import"./_baseClone.ce459c13.js";import"./_Uint8Array.869745a5.js";import"./_initCloneObject.d1045298.js";import"./event.1aa8b38f.js";import"./isEqual.3cc19f5b.js";import"./index.bccee1bd.js";const G={class:"login-bg"},H={class:"login-container"},Q={class:"pwd-tips"},W=I({__name:"login",setup(X){const d=localStorage.getItem("login-param"),l=d?JSON.parse(d):null,i=E(!!d),v=x(),o=A({username:l?l.username:"",password:l?l.password:"",sno:l?l.sno:""}),D={username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}],sno:[{required:!0,message:"\u8BF7\u8F93\u5165\u5DE5\u53F7",trigger:"blur"}]},B=U(),c=E(),f=p=>{!p||p.validate(e=>{if(e){const _={name:o.username,password:o.password,sno:o.sno};R.post("/api/login/adminlogin",_,{headers:{"Content-Type":"application/json"}}).then(s=>{if(s.data.data.message=="success"){r.success("\u767B\u5F55\u6210\u529F"),localStorage.setItem("vuems_name",o.username),localStorage.setItem("vuems_role",s.data.data.role),localStorage.setItem("vuems_token",s.data.data.token);const n=B.defaultList[o.username==="admin"?"admin":"user"];B.handleSet(n),v.push("/"),i.value?localStorage.setItem("login-param",JSON.stringify(o)):localStorage.removeItem("login-param")}else r.error("\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u8868\u5355\u586B\u5199\u662F\u5426\u6B63\u786E")}).catch(s=>{console.error(s),s.response?s.response.status===401?r.error("\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF"):r.error(`\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5 (${s.response.status})`):s.request?r.error("\u7F51\u7EDC\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u60A8\u7684\u7F51\u7EDC\u8FDE\u63A5"):r.error("\u53D1\u751F\u4E86\u4E00\u4E2A\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")})}else r.error("\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u8868\u5355\u586B\u5199\u662F\u5426\u6B63\u786E")})};return N().clearTabs(),(p,e)=>{const _=g("User"),s=M,n=h,F=J,b=g("Money"),k=g("Lock"),y=j,w=O,V=P,S=K;return T(),$("div",G,[m("div",H,[e[9]||(e[9]=m("div",{class:"login-header"},[m("img",{class:"logo mr10",src:q,alt:""}),m("div",{class:"login-title"},"\u5B9E\u8DF5\u8BFE\u7A0B\u7BA1\u7406\u7CFB\u7EDFPCMS")],-1)),u(S,{model:o,rules:D,ref_key:"login",ref:c,size:"large"},{default:t(()=>[u(F,{prop:"username"},{default:t(()=>[u(n,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=a=>o.username=a),placeholder:"\u7528\u6237\u540D"},{prepend:t(()=>[u(s,null,{default:t(()=>[u(_)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(F,{prop:"sno"},{default:t(()=>[u(n,{modelValue:o.sno,"onUpdate:modelValue":e[1]||(e[1]=a=>o.sno=a),placeholder:"\u5DE5\u53F7"},{prepend:t(()=>[u(s,null,{default:t(()=>[u(b)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(F,{prop:"password"},{default:t(()=>[u(n,{type:"password",placeholder:"\u5BC6\u7801",modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),onKeyup:e[3]||(e[3]=L(a=>f(c.value),["enter"]))},{prepend:t(()=>[u(s,null,{default:t(()=>[u(k)]),_:1})]),_:1},8,["modelValue"])]),_:1}),m("div",Q,[u(y,{class:"pwd-checkbox",modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value=a),label:"\u8BB0\u4F4F\u5BC6\u7801"},null,8,["modelValue"]),u(w,{type:"primary",onClick:e[5]||(e[5]=a=>p.$router.push("/reset-pwd"))},{default:t(()=>e[7]||(e[7]=[C("\u5FD8\u8BB0\u5BC6\u7801")])),_:1})]),u(V,{class:"login-btn",type:"primary",size:"large",onClick:e[6]||(e[6]=a=>f(c.value))},{default:t(()=>e[8]||(e[8]=[C("\u767B\u5F55")])),_:1})]),_:1},8,["model"])])])}}});const ce=z(W,[["__scopeId","data-v-2debe14c"]]);export{ce as default};
