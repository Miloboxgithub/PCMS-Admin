import{d as N,s as ue,v as a,S,T as te,x as ae,E as oe,o as n,a as le,y as s,e as re,j as m,w as o,f as C,I as p,U as se}from"./index.12244a07.js";import{T as q,E as ie,_ as ne,a as pe}from"./table-search.9a52be5d.js";import"./el-tag.9c674d0f.js";import{f as ce,a as de,S as Fe,D as k,e as me,u as Ee,c as Be}from"./index.e2c71170.js";import{T as Ae,E as fe}from"./table-custom.f6f335e2.js";import{E as be}from"./index.01a27f37.js";import{E as c}from"./index.85100a56.js";import"./event.1aa8b38f.js";import"./index.4d06eba3.js";import"./scroll.4bdf40b7.js";import"./el-form-item.ce222cb9.js";import"./_baseClone.ce459c13.js";import"./_Uint8Array.869745a5.js";import"./_initCloneObject.d1045298.js";import"./el-col.9d5e7896.js";import"./el-progress.d9524178.js";import"./cloneDeep.249e6c55.js";import"./isEqual.3cc19f5b.js";import"./el-date-picker.da63982f.js";import"./el-select.ff2d79de.js";/* empty css                 */import"./el-input-number.6962d3b9.js";import"./index.318875f8.js";import"./index.bccee1bd.js";import"./index.e921f451.js";import"./el-table-column.53d704a2.js";import"./isPlainObject.e6d32bd1.js";import"./_baseIteratee.ef24a81b.js";import"./debounce.b932a66e.js";import"./el-checkbox.4a8a00ed.js";import"./raf.294279dc.js";import"./index.07ec0462.js";import"./date.8d8ac76d.js";import"./axios.bf444489.js";import"./el-divider.e8ffbcc2.js";import"./strings.c7fbc6d7.js";const De={class:"container"},ve=N({name:"system-user"}),ru=N({...ve,setup(ye){const $=ue(),j=()=>{$.push("/login"),c.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25")};console.log(q.props,"search"),a(""),a("");const T=S({}),V=a([{type:"input",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u7F16\u53F7\u67E5\u8BE2\uFF1A",prop:"projectpracticeCode"}]);let U=a([{type:"selection",width:55,align:"center"},{prop:"ad",label:"\u5E8F\u53F7",width:55,align:"center"},{prop:"projectpracticeCode",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u7F16\u53F7"},{prop:"projectpracticeName",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u540D\u79F0"},{prop:"majorName",label:"\u4E13\u4E1A"},{prop:"grade",label:"\u5E74\u7EA7",width:75},{prop:"adminName",label:"\u8D1F\u8D23\u4EBA",width:85},{prop:"titleTime",label:"\u6559\u5E08\u51FA\u9898\u65F6\u95F4"},{prop:"selectTime",label:"\u5B66\u751F\u9009\u8BFE\u65F6\u95F4"},{prop:"status",label:"\u72B6\u6001"},{prop:"operatorno",label:"\u64CD\u4F5C",width:250}]);const i=S({index:1,size:20,total:0}),g=a(0),D=a([]),d=async(u,e)=>{const t=await ce(u,e);t=="Request failed with status code 403"&&j(),D.value=t.ProjectPracticeInfoList,i.total=t.total,g.value++,console.log(t,D.value,"tableData")};d(1,0),(async()=>{const u=await de();if(u.code!=50){let e=u.data.propracticeList;localStorage.setItem("v_codes",JSON.stringify(e))}else j()})();const L=async u=>{if(!u.projectpracticeCode)d(1,0);else{const e=await Fe(u.projectpracticeCode);e==null?c.error("\u67E5\u8BE2\u5931\u8D25"):(D.value=e.ProjectPracticeInfoList,i.total=e.total,g.value++)}};async function P(){fe.confirm("\u786E\u5B9A\u8981\u5BFC\u51FA\u8868\u683C\u5417\uFF1F","\u63D0\u793A",{type:"info"}).then(async()=>{const u=await me();if(u.code==50)c({type:"warning",message:"\u5BFC\u51FA\u5931\u8D25"});else{const e=window.URL.createObjectURL(new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");t.href=e,t.setAttribute("download","data.xlsx"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e),c({type:"success",message:"\u5BFC\u51FA\u6210\u529F"})}}).catch(()=>{})}const R=(u,e,t)=>{i.index=u,d(i.index,t)};function v(u){const e=new Date(u),t=e.getFullYear(),r=e.getMonth()+1,f=e.getDate(),E=e.getHours(),b=e.getMinutes(),B=e.getSeconds(),l=r<10?`0${r}`:r,Q=f<10?`0${f}`:f,X=E<10?`0${E}`:E,Z=b<10?`0${b}`:b,ee=B<10?`0${B}`:B;return`${t}-${l}-${Q} ${X}:${Z}:${ee}`}function M(u){const e=new Date().getFullYear(),t=[];for(let r=0;r<u;r++)t.push({label:e-r,value:e-r});return t}const h=M(4);let I=a({labelWidth:"140px",span:22,list:[{type:"alert"},{type:"input",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u540D\u79F0",prop:"projectpracticeName",required:!0},{type:"select",label:"\u4E13\u4E1A",prop:"majorName",required:!0,options:[{label:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316",value:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316"},{label:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F",value:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F"},{label:"\u81EA\u52A8\u5316",value:"\u81EA\u52A8\u5316"},{label:"\u673A\u5668\u4EBA\u5DE5\u7A0B",value:"\u673A\u5668\u4EBA\u5DE5\u7A0B"}]},{type:"select",label:"\u5E74\u7EA7",prop:"grade",required:!0,options:h},{type:"select",label:"\u72B6\u6001",prop:"status",required:!0,options:[{label:"\u672A\u5F00\u59CB",value:0},{label:"\u5DF2\u505C\u6B62",value:2},{label:"\u5DF2\u5F00\u59CB",value:1}]},{type:"date",label:"\u6559\u5E08\u51FA\u9898\u5F00\u59CB\u65F6\u95F4",prop:"titleStime",required:!0},{type:"date",label:"\u6559\u5E08\u51FA\u9898\u7ED3\u675F\u65F6\u95F4",prop:"titleEtime",required:!0},{type:"date",label:"\u5B66\u751F\u9009\u8BFE\u5F00\u59CB\u65F6\u95F4",prop:"selectStime",required:!0},{type:"date",label:"\u5B66\u751F\u9009\u8BFE\u7ED3\u675F\u65F6\u95F4",prop:"selectEtime",required:!0}]}),Y=a({labelWidth:"140px",span:22,list:[{type:"alert"},{type:"input",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u540D\u79F0",prop:"projectpracticeName",required:!0},{type:"select",label:"\u4E13\u4E1A",prop:"majorName",required:!0,options:[{label:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316",value:"\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316"},{label:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F",value:"\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F"},{label:"\u81EA\u52A8\u5316",value:"\u81EA\u52A8\u5316"},{label:"\u673A\u5668\u4EBA\u5DE5\u7A0B",value:"\u673A\u5668\u4EBA\u5DE5\u7A0B"}]},{type:"select",label:"\u5E74\u7EA7",prop:"grade",required:!0,options:h},{type:"select",label:"\u72B6\u6001",prop:"status",required:!0,options:[{label:"\u672A\u5F00\u59CB",value:0},{label:"\u5DF2\u505C\u6B62",value:2},{label:"\u5DF2\u5F00\u59CB",value:1}]},{type:"date",label:"\u6559\u5E08\u51FA\u9898\u5F00\u59CB\u65F6\u95F4",prop:"titleStime",required:!0},{type:"date",label:"\u6559\u5E08\u51FA\u9898\u7ED3\u675F\u65F6\u95F4",prop:"titleEtime",required:!0},{type:"date",label:"\u5B66\u751F\u9009\u8BFE\u5F00\u59CB\u65F6\u95F4",prop:"selectStime",required:!0},{type:"date",label:"\u5B66\u751F\u9009\u8BFE\u7ED3\u675F\u65F6\u95F4",prop:"selectEtime",required:!0}]});const A=a(!1),O=a(!1),F=a(!1);a(!1);const y=a({}),H=u=>{y.value={...u},F.value=!0,A.value=!0,d(1,0)},W={\u673A\u68B0\u8BBE\u8BA1\u5236\u4F5C\u53CA\u5176\u81EA\u52A8\u5316:"0101",\u7535\u5B50\u79D1\u5B66\u4E0E\u6280\u672F:"0102",\u673A\u5668\u4EBA\u5DE5\u7A0B:"0104",\u81EA\u52A8\u5316:"0103"},z=async u=>{if(u.selectEtime=v(u.selectEtime),u.selectStime=v(u.selectStime),u.titleEtime=v(u.titleEtime),u.titleStime=v(u.titleStime),u.majorCode=W[u.majorName],F.value)if(console.log(u,"\u7F16\u8F91\u6570\u636E"),"projectpracticeCode"in y.value){u.projectpracticeCode=y.value.projectpracticeCode;const e=await Ee(u);console.log(e,"\u66F4\u65B0\u6570\u636E")}else console.log("\u65E0\u6570\u636E");else{const e=await Be(u);console.log(e,"\u65B0\u5EFA\u6570\u636E")}x(),setTimeout(()=>{d(1,0)},500)},x=()=>{A.value=!1,O.value=!1,F.value=!1},w=a(!1),_=a({row:{},list:[]}),J=u=>{_.value.row={...u},_.value.list=[{prop:"ad",label:"\u5E8F\u53F7"},{prop:"projectpracticeCode",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u7F16\u53F7"},{prop:"projectpracticeName",label:"\u5B9E\u8DF5\u8BFE\u7A0B\u540D\u79F0"},{prop:"majorName",label:"\u4E13\u4E1A"},{prop:"grade",label:"\u5E74\u7EA7"},{prop:"adminName",label:"\u8D1F\u8D23\u4EBA"},{prop:"titleTime",label:"\u6559\u5E08\u51FA\u9898\u65F6\u95F4"},{prop:"selectTime",label:"\u5B66\u751F\u9009\u8BFE\u65F6\u95F4"},{prop:"status",label:"\u72B6\u6001"}],w.value=!0},K=u=>{let e=[];u.length>0&&u.forEach(t=>{e.push(t.projectpracticeCode)}),k(e).then(t=>{c.success("\u5220\u9664\u6210\u529F"),d(1,0),i.index=1}).catch(t=>{c.error("\u5220\u9664\u5931\u8D25")})},G=async u=>{(await k(u.projectpracticeCode)).data.message=="success"?c.success("\u5220\u9664\u6210\u529F"):c.error("\u5220\u9664\u5931\u8D25"),d(1,0),i.index=1};return(u,e)=>{const t=be,r=te,f=ae("UploadFilled"),E=oe,b=pe,B=ie;return n(),le("div",null,[s(q,{query:T,options:V.value,search:L},null,8,["query","options"]),re("div",De,[(n(),m(Ae,{key:g.value,columns:C(U),tableData:D.value,total:i.total,currentPage:i.index,viewFunc:J,delFunc:G,changePage:R,editFunc:H,delSelection:K},{status:o(({rows:l})=>[l.status==0?(n(),m(t,{key:0,type:"warning"},{default:o(()=>e[4]||(e[4]=[p("\u672A\u5F00\u59CB")])),_:1})):l.status==1?(n(),m(t,{key:1,type:"success"},{default:o(()=>e[5]||(e[5]=[p("\u5DF2\u5F00\u59CB")])),_:1})):(n(),m(t,{key:2,type:"info"},{default:o(()=>e[6]||(e[6]=[p("\u5DF2\u505C\u6B62")])),_:1}))]),toolbarBtn:o(()=>[s(r,{type:"warning",icon:C(se),onClick:e[0]||(e[0]=l=>{A.value=!0,F.value=!1})},{default:o(()=>e[7]||(e[7]=[p("\u65B0\u589E\u5B9E\u8DF5\u8BFE\u7A0B")])),_:1},8,["icon"]),s(r,{type:"success",onClick:e[1]||(e[1]=l=>P())},{default:o(()=>[s(E,{style:{"margin-right":"5px"}},{default:o(()=>[s(E,null,{default:o(()=>[s(f)]),_:1})]),_:1}),e[8]||(e[8]=p(" \u5BFC\u51FA "))]),_:1})]),_:1},8,["columns","tableData","total","currentPage"]))]),s(B,{title:F.value?"\u7F16\u8F91":"\u65B0\u589E\u5B9E\u8DF5\u8BFE\u7A0B",modelValue:A.value,"onUpdate:modelValue":e[2]||(e[2]=l=>A.value=l),width:"700px","destroy-on-close":"","close-on-click-modal":!1,onClose:x,bu:""},{default:o(()=>[s(b,{"form-data":y.value,options:F.value?C(I):C(Y),edit:F.value,update:z},null,8,["form-data","options","edit"])]),_:1},8,["title","modelValue"]),s(B,{title:"\u67E5\u770B\u8BE6\u60C5",modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=l=>w.value=l),width:"700px","destroy-on-close":""},{default:o(()=>[s(ne,{data:_.value},{status:o(({rows:l})=>[l.status==0?(n(),m(t,{key:0,type:"warning"},{default:o(()=>e[9]||(e[9]=[p("\u672A\u5F00\u59CB")])),_:1})):l.status==1?(n(),m(t,{key:1,type:"success"},{default:o(()=>e[10]||(e[10]=[p("\u5DF2\u5F00\u59CB")])),_:1})):(n(),m(t,{key:2,type:"info"},{default:o(()=>e[11]||(e[11]=[p("\u5DF2\u505C\u6B62")])),_:1}))]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}});export{ru as default};
